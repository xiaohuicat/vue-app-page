var j=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var K=(o,t)=>{for(var e in t)j(o,e,{get:t[e],enumerable:!0})},Q=(o,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of G(t))!H.call(o,n)&&n!==e&&j(o,n,{get:()=>t[n],enumerable:!(s=q(t,n))||s.enumerable});return o};var W=o=>Q(j({},"__esModule",{value:!0}),o);var st={};K(st,{Callback:()=>h,LocalStore:()=>u,Page:()=>b,Tools:()=>I,default:()=>et,templateToComponment:()=>J});module.exports=W(st);var h=class{constructor(t={}){this.callbackDict=t}add_hard(t,e){this.callbackDict[t]=e}add(t,e){if(t==="string"&&typeof e=="function")if(t in this.callbackDict){let s=Array.isArray(this.callbackDict[t])?this.callbackDict[t]:[this.callbackDict[t]];s.push(e),this.callbackDict[t]=s}else this.callbackDict[t]=e;t==="object"&&Object.keys(t).forEach(s=>{this.add(s,t[s])})}get(t){let e=this.callbackDict[t];return e?Array.isArray(e)?e:[e]:[]}getDict(){return this.callbackDict}run(t,...e){return this.get(t).map(s=>s(...e))}remove(t){t?delete this.callbackDict[t]:this.callbackDict={}}destroy(){this.callbackDict={}}};var _=require("vue-router");function A(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)}function C(o,t,e){let s=t.split("."),n=o;for(let r=0;r<s.length;r++){if(!n[s[r]])return e;n=n[s[r]]}return n}function y(o,t,e){let s=t.split("."),n=o;for(let r=0;r<s.length-1;r++)n[s[r]]||(n[s[r]]={}),n=n[s[r]];return n[s[s.length-1]]=e,o}function L(o,t,e){let s=t.split("."),n=o;for(let r of s){if(!n[r])break;n=n[s[i]]}return n[s[s.length-1]]=e,o}function P(o,t,e){var s=new Blob([o],{type:e});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(s,t);else{var n=document.createElement("a"),r=URL.createObjectURL(s);n.href=r,n.download=t,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(r)},0)}}function F(o,t){var e=document.createElement("a");e.href=o,e.download=t,document.body.appendChild(e),e.click(),setTimeout(function(){document.body.removeChild(e),window.URL.revokeObjectURL(o)},0)}var a=require("vue");var u=class{constructor(t){this.name=t||"LocalStore",this.data=null}get(t,e){let s;try{s=JSON.parse(localStorage.getItem(this.name))}catch{s={}}return s||(s={}),this.data,!t&&typeof t!="string"?s:C(s,t,e)}set(t,e){if(t){if(typeof t=="string")this.data=y(this.data,t,e);else if(typeof t=="object")for(let s of Object.keys(t))this.data||(this.data={}),this.data[s]=t[s]}}update(t,e){if(t){if(typeof t=="string")this.data=L(this.data,t,e);else if(typeof t=="object")for(let s of Object.keys(t))s in this.data&&(this.data||(this.data={}),this.data[s]=t[s])}}delete(t){t&&t in this.data&&delete this.get(t)}save(t,e){this.set(t,e),localStorage[this.name]=JSON.stringify(this.data)}free(){this.data=null}clear(){delete localStorage[this.name]}size(){let t=localStorage.getItem(this.name)||"";return new Blob([t]).size}};var D=class{constructor(){this.tasks=[],this.statusMap=new Map}add(t,e,s){let n=`task_${this.tasks.length}`;this.tasks.push({name:n,range:t,success:e,fail:s})}addList(t){t.forEach(e=>{this.add(e.range,e.success,e.fail)})}run(t){this.tasks.forEach(e=>{let{name:s,range:n,success:r,fail:c}=e;t>=n[0]&&t<n[1]?(this.statusMap.has(s)||this.statusMap.set(s,!1),this.statusMap.get(s)!==!0&&(r&&r(t),this.statusMap.set(s,!0))):(this.statusMap.has(s)||this.statusMap.set(s,!0),this.statusMap.get(s)!==!1&&(c&&c(t),this.statusMap.set(s,!1)))})}destroy(){this.tasks=[],this.statusMap.clear()}};var M={onMounted:a.onMounted,onBeforeMount:a.onBeforeMount,onBeforeUpdate:a.onBeforeUpdate,onUpdated:a.onUpdated,onUnmounted:a.onUnmounted,onBeforeUnmount:a.onBeforeUnmount,onLoad:a.onBeforeMount,onReady:a.onMounted,onDestroy:a.onUnmounted};function k(o,t){if(typeof o=="function")try{o.call(t)}catch(e){console.log(e)}}function N(o){return typeof o=="function"?(0,a.computed)(o):(0,a.ref)(o)}function U(o,t){for(let e in t)o[e]=N(t[e]);return o}function E(o,t){for(let e in t)o[e]=typeof t[e]=="function"?t[e]:()=>t[e];return o}var b=class{constructor(t){this.instance=(0,a.getCurrentInstance)();let{props:e,emit:s,proxy:n}=this.instance;this.props=e,this.emit=s,this.$=new Proxy({...n},{get:(r,c)=>typeof c=="string"&&c.indexOf("[getRef]")>-1?(c=c.replace("[getRef]",""),r[c]):(0,a.isRef)(r[c])?r[c].value:r[c],set:(r,c,f)=>typeof c=="string"&&c.indexOf("[setRef]")>-1?(c=c.replace("[setRef]",""),r[c]=(0,a.isRef)(f)?f:N(f),!0):(c in r&&(0,a.isRef)(r[c])?r[c].value=f:r[c]=f,!0)}),this.router=(0,_.useRouter)(),this.callback=new h,this.rangeTask=new D,this.local=new u(t||"app-page-store"),(0,a.onUnmounted)(()=>this?.destroy())}setRefs(t){this.instance.proxy=U(this.$,t)}setRef(t,e){let[s,...n]=t.split("."),r={};this.$&&s in this.$?(r=this.$[s],this.$["[setRef]"+s]=n.length>0?y(r,n.join("."),e):e):this.instance.proxy=U(this.$,{[t]:e})}getRef(t){return this.$["[getRef]"+t]}set(t,e){let[s,...n]=t.split("."),r={};this.$&&s in this.$?(r=this.$[s],this.$[s]=n.length>0?y(r,n.join("."),e):e):this.instance.proxy=U(this.$,{[t]:e})}get(t){return this.$[t]}setFuns(t){this.instance.proxy=E(this.$,t)}setFun(t,e){this.instance.proxy=E(this.$,{[t]:e})}getFun(t){return this.$[t]}watch(t,e){(0,a.watch)(t,(s,n)=>{typeof e=="function"?e(s,n):this.callback.run(e,s,n)})}watchRef(t,e){let[s,...n]=t.split(".");if(!(this.$&&s in this.$)){console.log(`refs\u4E2D\u6CA1\u6709\u8BE5${s}\uFF0C\u68C0\u67E5\u662F\u5426\u521D\u59CB\u5316\uFF01`);return}(0,a.watch)(()=>{let r=this.$[s];if(n.length)for(let c=0;c<n.length;c++)r=r[n[c]];return r},(r,c)=>{typeof e=="function"?e(r,c):this.callback.run(e,r,c)})}watchProps(t,e){if(!(this.props&&t in this.props)){console.log(`props\u4E2D\u6CA1\u6709\u8BE5${t}\uFF0C\u68C0\u67E5\u662F\u5426\u521D\u59CB\u5316\uFF01`);return}(0,a.watch)(this.props[t].value?this.props[t]:()=>this.props[t],(s,n)=>{typeof e=="function"?e(s,n):this.callback.run(e,s,n)})}setLives(t){if(A(t))for(let e in t)if(e in M){let s=t[e];if(typeof s!="function"){console.log(`${e}'s value need to be a function`);return}M[e](()=>k(s,this))}else console.log(`${e} is not a life function`)}setLive(t,e){if(typeof t=="string"&&typeof e=="function")if(t in M){if(typeof e!="function"){console.log("func need to be a function");return}M[t](()=>k(e,this))}else console.log(`${t} is not a life function`)}destroy(){this.instance=null,this.props=null,this.emit=null,this.proxy=null,this.$=null,this.router=null,this.local.free(),this.local=null,this.rangeTask.destroy(),this.rangeTask=null,this.callback.run("destroy"),this.callback.destroy(),this.callback=null}binds(t){for(let e in t){let s=t[e];typeof s=="function"?this[e]=(...n)=>s.call(this,...n):this[e]=s}}bind(t,e){typeof t=="string"&&(typeof e=="function"?this[t]=(...s)=>e.call(this,...s):this[t]=e)}};function X(o){o==""||o=="#"||o==null||(o.indexOf("[hard]")>-1?(o=o.replace("[hard]",""),document.location.href=o):this?.router?this.router.push({path:o}):document.location.href=o)}async function Y(o){try{await navigator.clipboard.writeText(o),this?.msg&&this.msg.showMsg("\u590D\u5236\u6210\u529F","success")}catch{let e=await navigator.permissions.query({name:"write-on-clipboard"});e.state=="granted"||e.state=="prompt"?this?.msg&&this.msg.showMsg("\u6CA1\u6709\u6743\u9650","fail"):this?.msg&&this.msg.showMsg("\u590D\u5236\u5931\u8D25","fail")}}var I={downloadFileByData:P,downloadFileByUrl:F,copyText:Y,goToUrl:X};var l=require("vue");function Z(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)}function V(o,t){let e=o.indexOf(t);if(e!==-1){let s=o.substring(0,e),n=o.substring(e+t.length);return{left:s,right:n}}else return{left:o,right:""}}function J({componentMap:o,template:t,props:e,events:s,mainClass:n="dyComponent"}){let r=0,c=t.split(`
`),f=[];return c.forEach(p=>{if(!p||p.trim()==="")return;let w=p.match(/\{\{(.*?)\}\}/g);if(!w){f.push((0,l.h)("div",{class:n},p.trim()));return}let d=[],g=p;for(let O=0;O<w?.length;O++){let z=w[O].slice(2,-2),[B,S]=tt(z),$={},T={},m=o?.[B],{left:x,right:v}=V(g,w[O]);if(!m){d.push((0,l.h)("span",{},x+B)),g=v;continue}if(S||(typeof e=="function"?$=e(r):Array.isArray(e)&&e.length>r?$=e[r]:Z(e)&&($=e),r++),s)for(let R of Object.keys(s))typeof s[R]=="function"&&(T[`on${R.slice(0,1).toUpperCase()+R.slice(1)}`]=s[R]);x&&x.trim()&&d.push((0,l.h)("span",{},x)),typeof m=="function"&&(m=m(e)),d.push((0,l.h)(m,{...$,...T,...S})),g=v}g&&d.push((0,l.h)("span",{},g)),f.push((0,l.h)("div",{class:n},d))}),(0,l.defineComponent)({render:()=>f})}function tt(o){let t,e=null,s=o.match(/\([^)]*\)/g);if(!s)return t=o,[t,e];t=o.split(s[0])[0];let n=s[0].slice(1,-1);if(e={},n.length>0)try{e=JSON.parse(n)}catch{e.text=n}return[t,e]}var et=b;0&&(module.exports={Callback,LocalStore,Page,Tools,templateToComponment});
